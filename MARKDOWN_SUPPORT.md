# Markdown 格式支持

## 功能概述

文本对比编辑器现在支持 **Markdown 格式**！你可以输入 Markdown 文本，并在主视图中以渲染后的格式查看差异对比。

## 使用方法

### 1. 切换视图模式

工具栏右侧有 Markdown 模式切换按钮：

```
[📝 Markdown]  ← 点击切换
[📄 纯文本]
```

- **📝 Markdown**：以渲染后的格式显示文本
- **📄 纯文本**：以原始文本格式显示

### 2. 输入 Markdown 文本

在侧边栏的"原始文本"和"新文本"输入框中，可以输入标准的 Markdown 格式：

#### 支持的语法

**标题**
```markdown
# 一级标题
## 二级标题
### 三级标题
```

**强调**
```markdown
**粗体文本**
*斜体文本*
***粗斜体***
```

**代码**
```markdown
行内代码：`const x = 10`

代码块：
\`\`\`javascript
function hello() {
  console.log("Hello!");
}
\`\`\`
```

**列表**
```markdown
- 无序列表项 1
- 无序列表项 2

1. 有序列表项 1
2. 有序列表项 2
```

**引用**
```markdown
> 这是一段引用文本
```

**链接**
```markdown
[链接文本](https://example.com)
```

**分隔线**
```markdown
---
```

**表格**
```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 数据1 | 数据2 | 数据3 |
```

## 视图效果

### 纯文本模式
```
显示原始的 Markdown 语法：
# 标题
**粗体** *斜体*
```

### Markdown 模式
```
渲染后的效果：
━━━━━━━━━━━━━━━━
标题
━━━━━━━━━━━━━━━━
粗体 斜体
```

## Diff 对比体验

### 未变更部分
- 以渲染后的 Markdown 格式显示
- 可以直接编辑（需开启编辑模式）
- 保持美观的排版

### 变更块

#### 删除块（红色）
```
🔴 删除
━━━━━━━━━━━━━━━━
标题变化前
━━━━━━━━━━━━━━━━
段落内容...
```

#### 新增块（绿色）
```
🟢 新增
━━━━━━━━━━━━━━━━
标题变化后
━━━━━━━━━━━━━━━━
段落内容...
```

#### 修改块（红+绿）
```
🔄 修改（删除旧内容 + 添加新内容作为整体操作）

🔴 删除
标题的旧版本

🟢 新增
标题的新版本
```

## 使用场景

### 1. 文档修订对比
```markdown
场景：对比文档的不同版本

原文：
# 用户指南
这是旧版本的说明。

修改后：
# 用户指南
这是**更新版本**的说明。

→ 在 Markdown 模式下查看，可以清晰看到格式化的差异
```

### 2. README 文件编辑
```markdown
对比 README.md 的修改：
- 查看标题层级变化
- 对比代码示例
- 审查格式调整
```

### 3. 博客文章修订
```markdown
文章草稿 vs 修订版：
- 标题优化
- 段落重组
- 格式美化
- 代码块更新
```

### 4. 技术文档审查
```markdown
API 文档修改：
- 方法签名变更
- 参数说明更新
- 示例代码优化
- 注意事项补充
```

### 5. 会议纪要对比
```markdown
初稿 vs 定稿：
- 内容补充
- 格式调整
- 重点标记
```

## 技术特点

### Markdown 渲染
- 基于 `markdown-it` 解析器
- 支持 HTML 标签
- 自动链接识别
- 排版优化

### 样式特性
- 深色主题适配
- 语法高亮支持
- 代码块美化
- 表格样式
- 响应式设计

### 编辑体验
- **纯文本模式**：编辑 Markdown 源码
- **Markdown 模式**：查看渲染效果
- 实时切换，无缝体验

## 示例对比

### 示例 1：标题变更

**原文（纯文本）**
```
## 功能说明
该函数用于计算...
```

**新文（纯文本）**
```
## 功能说明（增强版）
该函数用于计算订单总价，支持折扣...
```

**Markdown 渲染效果**
```
━━━━━━━━━━━━━━━━━━━━━━
功能说明         → 功能说明（增强版）
━━━━━━━━━━━━━━━━━━━━━━
该函数用于计算... → 该函数用于计算订单总价，支持折扣...
```

### 示例 2：代码块变更

**原文**
````markdown
```javascript
function old() {
  return 1;
}
```
````

**新文**
````markdown
```javascript
function improved() {
  return 2;
}
```
````

**Markdown 模式查看**
- 代码高亮显示
- 对比更清晰
- 格式保留

### 示例 3：列表修改

**原文**
```markdown
- 功能 A
- 功能 B
```

**新文**
```markdown
- 功能 A（已优化）
- 功能 B
- 功能 C（新增）
```

**渲染对比**
```
• 功能 A          → • 功能 A（已优化）
• 功能 B            • 功能 B
                    • 功能 C（新增）
```

## 工作流程

### 典型流程

```
1. 准备 Markdown 文档
   ↓
2. 粘贴到原始文本和新文本框
   ↓
3. 点击切换到 Markdown 模式
   ↓
4. 查看渲染后的差异对比
   ↓
5. 逐个接受/拒绝变更
   ↓
6. 应用更改，得到最终版本
```

### 编辑流程

```
Markdown 模式（查看）
  ↓
发现需要修改
  ↓
切换到纯文本模式（编辑源码）
  ↓
修改 Markdown 语法
  ↓
切换回 Markdown 模式（查看效果）
  ↓
确认无误
```

## 最佳实践

### 1. 查看时用 Markdown 模式
- 更直观
- 更美观
- 更易理解

### 2. 编辑时用纯文本模式
- 精确控制
- 语法清晰
- 避免格式混乱

### 3. 结合使用
```
查看差异 → Markdown 模式
编辑内容 → 纯文本模式
最终确认 → Markdown 模式
```

### 4. 利用实时切换
- 随时切换查看
- 灵活对比
- 快速验证

## 注意事项

### ⚠️ 编辑限制

在 **Markdown 模式 + 编辑模式** 下编辑可编辑区域：
- 编辑的是渲染后的 HTML
- 保存时会提取文本内容
- 可能丢失部分 Markdown 格式
- **建议**：编辑时切换到纯文本模式

### 💡 建议做法

1. **查看差异**：使用 Markdown 模式
2. **修改内容**：
   - 切换到纯文本模式
   - 在侧边栏编辑
   - 或关闭内联编辑
3. **最终确认**：切换回 Markdown 模式

### 🎯 最佳体验

```
[📄 纯文本] + [✏️ 编辑中] → 适合编辑
[📝 Markdown] + [🔒 只读] → 适合查看
```

## 键盘快捷键（建议）

未来可以添加：
- `Ctrl/Cmd + M`：切换 Markdown 模式
- `Ctrl/Cmd + P`：切换纯文本模式
- `Ctrl/Cmd + Shift + V`：预览模式

## 与其他功能的集成

### 接受/拒绝变更
- Markdown 模式下正常工作
- 渲染效果不影响决策
- 最终结果保留 Markdown 格式

### 应用更改
- 保留原始 Markdown 语法
- 渲染仅用于显示
- 数据不会丢失

### 复制结果
- 复制的是 Markdown 源码
- 不是渲染后的 HTML
- 可以直接使用

### 内联编辑
- 建议在纯文本模式下使用
- Markdown 模式主要用于查看

## 示例截图说明

### 默认示例（Markdown）
系统现在默认加载 Markdown 格式的示例：
- 标题层级
- 代码块
- 列表
- 强调文本
- 完整的文档结构

### 切换效果
- **纯文本模式**：看到原始的 `#`、`**`、`` ` `` 等语法
- **Markdown 模式**：看到渲染后的标题、粗体、代码块

## 技术实现

### 渲染逻辑
```javascript
const renderMarkdown = (text) => {
  if (viewMode.value === 'markdown') {
    return md.render(text)
  }
  return text
}
```

### 条件渲染
```vue
<!-- 纯文本 -->
<pre v-if="!isMarkdownMode">{{ text }}</pre>

<!-- Markdown -->
<div v-else v-html="renderMarkdown(text)"></div>
```

### 样式隔离
- 使用 `:deep()` 选择器
- 深色主题适配
- 不影响其他元素

---

**总结**：Markdown 支持让文档对比变得更加直观和美观，特别适合技术文档、README 文件、博客文章等场景的修订审查！📝✨


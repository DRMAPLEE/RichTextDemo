# Tiptap Markdown 支持指南

## 概述

现在侧边栏使用了**真正的 Tiptap 编辑器**，支持实时的 Markdown 语法识别和转换！

## ✨ 核心特性

### 1. **自动 Markdown 转换**
当你输入 Markdown 语法时，Tiptap 会自动将其转换为富文本格式：

```
输入：# 标题
结果：自动变成大标题

输入：**粗体**
结果：自动变成粗体文本

输入：- 列表项
结果：自动变成无序列表
```

### 2. **所见即所得**
- 不需要预览模式
- 编辑时就能看到最终效果
- 实时渲染，流畅体验

### 3. **智能识别**
- 自动识别 Markdown 快捷输入
- 支持快捷键操作
- 保留原始文本用于 diff 对比

## 📝 支持的 Markdown 快捷输入

### 标题
```
# 一级标题    + Space → 变成 H1
## 二级标题   + Space → 变成 H2
### 三级标题  + Space → 变成 H3
#### 四级标题 + Space → 变成 H4
##### 五级标题 + Space → 变成 H5
###### 六级标题 + Space → 变成 H6
```

### 文本样式
```
**粗体文本**  → 自动变粗体
*斜体文本*   → 自动变斜体
~~删除线~~   → 自动加删除线
`代码`       → 自动变行内代码
```

### 列表
```
- 无序列表   + Space → 创建无序列表
* 无序列表   + Space → 创建无序列表
1. 有序列表  + Space → 创建有序列表
```

### 引用
```
> 引用文本   + Space → 创建引用块
```

### 代码块
```
``` + Space   → 创建代码块
```语言名     → 创建指定语言的代码块
```

### 分隔线
```
--- + Enter  → 创建分隔线
*** + Enter  → 创建分隔线
```

## 🎯 使用方式

### 在侧边栏编辑

1. **原始文本编辑器**（左侧）
   - 点击进入编辑
   - 输入 Markdown 语法
   - 自动转换为富文本
   - 内容自动同步用于 diff 对比

2. **新文本编辑器**（右侧）
   - 同样支持 Markdown
   - 独立编辑
   - 实时对比

### 示例工作流

```
1. 在"原始文本"中输入：
   # 用户指南
   这是一个**重要**的说明。

2. 在"新文本"中输入：
   # 用户指南
   这是一个**非常重要**的说明。

3. 主视图自动显示差异：
   - 标题保持不变
   - "重要" → "非常重要" 的变更高亮显示
```

## ✨ 编辑器提示

当编辑器为空或未聚焦时，会显示提示：

```
💡 支持Markdown快捷输入：
   # 标题，**粗体**，*斜体*，- 列表，> 引用，```代码块
```

聚焦后提示自动隐藏，让你专注编辑。

## 🎨 视觉效果

### 标题样式
- **H1**：超大字号 + 底部边框
- **H2**：大字号 + 底部边框
- **H3-H6**：逐级递减

### 文本样式
- **粗体**：加粗显示，白色
- *斜体*：倾斜显示，蓝色
- `代码`：深色背景，青绿色

### 列表
- 无序列表：圆点标记
- 有序列表：数字标记
- 自动缩进

### 引用
- 左侧青绿色边框
- 灰色文本

### 代码块
- 深色背景
- 等宽字体
- 圆角边框

## 🚀 快捷键

Tiptap 内置快捷键：

```
Ctrl/Cmd + B      → 粗体
Ctrl/Cmd + I      → 斜体
Ctrl/Cmd + Shift + X → 删除线
Ctrl/Cmd + E      → 代码
Ctrl/Cmd + Z      → 撤销
Ctrl/Cmd + Shift + Z → 重做
```

## 🔄 与 Diff 对比的集成

### 工作原理

```
Tiptap 编辑器
    ↓
自动提取纯文本 (getText())
    ↓
存储到 originalText / newText
    ↓
Diff 算法对比
    ↓
主视图显示差异
```

### 关键特性

1. **双向同步**
   - Tiptap 内容变化 → 自动更新文本
   - 文本变化 → 自动触发 diff

2. **格式保留**
   - Tiptap 保留富文本格式
   - Diff 使用纯文本对比
   - 互不干扰

3. **实时对比**
   - 编辑即时生效
   - Diff 立即更新
   - 无需手动刷新

## 💡 使用技巧

### 1. 快速创建结构化文档

```
输入：
# 标题
## 子标题
- 要点 1
- 要点 2

Tiptap 自动识别并格式化
```

### 2. 利用快捷键提高效率

```
选中文本 + Ctrl/Cmd + B → 快速加粗
选中文本 + Ctrl/Cmd + I → 快速斜体
```

### 3. 代码编辑

```
输入 ```javascript
自动创建代码块
输入代码
自动保持格式
```

### 4. 列表嵌套

```
- 一级列表
  - 二级列表（Tab 缩进）
    - 三级列表（再次 Tab）
```

## 🔒 编辑锁定

每个编辑器都有锁定按钮：
- 🔓 **解锁**：可以编辑
- 🔒 **锁定**：只读状态

锁定后：
- 防止误操作
- 保护内容
- 仍可查看

## 📊 对比优势

### 传统方式（textarea）
```
输入：# 标题
显示：# 标题（原始语法）
需要：想象最终效果
```

### Tiptap 方式
```
输入：# 标题
显示：[大标题样式]
看到：实际渲染效果
```

## 🎯 实际应用场景

### 场景 1：文档修订
```
原文编辑器：输入旧版文档
新文编辑器：输入新版文档
主视图：查看具体变更
所有编辑器都支持 Markdown！
```

### 场景 2：README 优化
```
原文：当前的 README.md
新文：改进后的版本
对比：逐个审查改进点
```

### 场景 3：博客文章迭代
```
原文：初稿
新文：修订稿
对比：查看修改内容
全程 Markdown 支持！
```

## 🔧 技术实现

### Tiptap 配置

```javascript
new Editor({
  extensions: [
    StarterKit.configure({
      heading: {
        levels: [1, 2, 3, 4, 5, 6],
      },
    }),
    Highlight,
  ],
  onUpdate: ({ editor }) => {
    // 提取纯文本用于 diff
    originalText.value = editor.getText()
    onTextChange()
  },
})
```

### 自动同步

```javascript
watch(editOriginal, (value) => {
  originalTiptapEditor.value.setEditable(value)
})
```

## 🎨 样式定制

编辑器使用深色主题：
- 背景：#1e1e1e
- 文本：#d4d4d4
- 高亮：青绿色系
- 代码：等宽字体

与主视图风格一致！

## 📝 注意事项

### ✅ 优点
- 自动 Markdown 转换
- 所见即所得
- 实时渲染
- 快捷键支持
- 美观的样式

### ⚠️ 注意
- 编辑器提取的是纯文本用于 diff
- 富文本格式不影响对比逻辑
- 应用更改后保留文本内容

## 🚀 开始使用

1. 刷新页面
2. 在侧边栏看到 Tiptap 编辑器
3. 看到提示："✨ Markdown支持"
4. 输入 `# 标题` 然后按空格
5. 看到自动转换为大标题！
6. 继续输入其他 Markdown 语法
7. 观察主视图的 diff 对比

## 🎉 总结

现在你拥有了：
- ✨ **真正的 Tiptap 编辑器**
- 📝 **自动 Markdown 识别**
- 🎨 **美观的富文本格式**
- 🔄 **实时 Diff 对比**
- ⚡ **流畅的编辑体验**

这才是 Tiptap 的正确使用方式！享受编辑吧！🎊

